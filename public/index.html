<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>CHG - Clinical Toolkit</title>
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="CHG Toolkit">
  <link rel="apple-touch-icon" href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFzwIoH5I9Dg_dwbN_Kc4B2KdJiTjIVJIc45xnOQ28R2dw75hGSE97vmQpYfXKO1r0qAceEw2kpp78Y_aTgD6YCZfpZiMC8bStPrEDYzOUSUV96h9kYYcS5PD_nAltwlYEL1umN-Z6KjXfyIaFEU-OP4-Ldo6r1V9ZZwfp3AG1YDJYGoOsgWKNcoT3igc4/s192/bc19f2e5-04b9-441b-a4f4-ccf4fe8e8d31.png">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Header -->
  <header class="app-header">
    <button class="header-icon-button" id="header-back-button" aria-label="Go back">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
    </button>
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFzwIoH5I9Dg_dwbN_Kc4B2KdJiTjIVJIc45xnOQ28R2dw75hGSE97vmQpYfXKO1r0qAceEw2kpp78Y_aTgD6YCZfpZiMC8bStPrEDYzOUSUV96h9kYYcS5PD_nAltwlYEL1umN-Z6KjXfyIaFEU-OP4-Ldo6r1V9ZZwfp3AG1YDJYGoOsgWKNcoT3igc4/s192/bc19f2e5-04b9-441b-a4f4-ccf4fe8e8d31.png" alt="Logo" class="app-header-logo">
    <h1 id="app-title">CHG Toolkit</h1>
    <div class="header-spacer"></div>
    <button id="dark-mode-toggle" class="header-icon-button">
      <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
      <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
    </button>
  </header>

  <!-- Content -->
  <main class="app-content">
    
    <!-- Dashboard -->
    <div id="view-dashboard" class="view active">
      <div class="dashboard-grid">
        
        <!-- Heparin: Syringe (Line) -->
        <div class="tool-card" data-nav="heparin">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m18 2 4 4"/><path d="m17 7 3-3"/><path d="M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-2.6-2.6c-1-1-1-2.5 0-3.4L15 1"/><path d="m9 15 4-4"/><path d="m5 19 4-4"/>
          </svg>
          <span class="tool-card-title">Heparin<br>Calculator</span>
        </div>
        
        <!-- Prophylaxis: Shield (Line) -->
        <div class="tool-card" data-nav="prophylaxis">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          </svg>
          <span class="tool-card-title">Stress Ulcer<br>Prophylaxis</span>
        </div>
        
        <!-- Padua: Bed (Line) -->
        <div class="tool-card" data-nav="padua">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M2 4v16"/><path d="M2 8h18a2 2 0 0 1 2 2v10"/><path d="M2 17h20"/><path d="M6 8v9"/>
          </svg>
          <span class="tool-card-title">Padua (VTE)<br>Score</span>
        </div>
        
        <!-- IV: Droplet (Line) -->
        <div class="tool-card" data-nav="iv">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-5-5.5c-1.5-1.5-3-3.5-5-5.5S0 8 0 15a7 7 0 0 0 7 7z"/>
          </svg>
          <span class="tool-card-title">IV Infusion<br>Calculator</span>
        </div>
        
        <!-- Renal: Filter (Line) -->
        <div class="tool-card" data-nav="renal">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
          </svg>
          <span class="tool-card-title">Renal Dosing<br>(CrCl)</span>
        </div>
        
        <!-- Other Scores: Clipboard (Line) -->
        <div class="tool-card" data-nav="scores">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
          </svg>
          <span class="tool-card-title">Other<br>Clinical Scores</span>
        </div>
        
        <!-- Unit Converter: Arrows (Line) -->
        <div class="tool-card" data-nav="converter">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m16 3 4 4-4 4"/><path d="M20 7H4"/><path d="m8 21-4-4 4-4"/><path d="M4 17h16"/>
          </svg>
          <span class="tool-card-title">Unit<br>Converter</span>
        </div>
      </div>
    </div>
    
    <!-- Heparin View -->
    <div id="view-heparin" class="view">
      <div class="calculator-view">
        <div class="mode-toggle-buttons">
          <button id="heparin-mode-initial" class="mode-btn active">Initial Heparin</button>
          <button id="heparin-mode-maintenance" class="mode-btn">Maintenance Heparin</button>
        </div>
        <form id="heparin-form" class="space-y-4">
          <div class="input-group">
            <label for="heparin-patientName">Patient Name:</label>
            <input type="text" id="heparin-patientName" required>
          </div>
          <div class="input-group">
            <label for="heparin-patientIdentifier">Patient ID / Room No.:</label>
            <input type="text" id="heparin-patientIdentifier" required>
          </div>
          <div class="input-group">
            <label for="heparin-weight">Patient Weight (kg):</label>
            <input type="number" id="heparin-weight" step="0.1" required>
          </div>
          <div class="input-group">
            <label for="heparin-concentration">Heparin Concentration (units/mL):</label>
            <input type="number" id="heparin-concentration" step="0.1" value="100" required>
          </div>
          <div id="heparin-initial-fields" class="space-y-4">
            <div class="input-group">
              <label for="heparin-indication">Indication:</label>
              <select id="heparin-indication" required>
                <option value="AF">AF (Atrial Fibrillation)</option>
                <option value="Venous thromboembolism">Venous Thromboembolism</option>
                <option value="Acute coronary syndrome">Acute Coronary Syndrome</option>
              </select>
            </div>
          </div>
          <div id="heparin-maintenance-fields" class="hidden space-y-4">
            <div class="input-group">
              <label for="heparin-currentRate">Current Infusion Rate (mL/hour):</label>
              <input type="number" id="heparin-currentRate" step="0.1">
            </div>
            <div class="input-group">
              <label for="heparin-currentPtt">Current PTT Value (seconds):</label>
              <input type="number" id="heparin-currentPtt" step="0.1">
            </div>
          </div>
          <button type="submit" class="btn w-full" id="heparin-calculate-btn">
            <span>Calculate</span>
          </button>
        </form>
        <div id="heparin-result-area" class="mt-4"></div>
      </div>
    </div>
    
    <!-- Prophylaxis View -->
    <div id="view-prophylaxis" class="view">
      <div class="calculator-view">
        <h2 class="calculator-title">Stress Ulcer Prophylaxis</h2>
        <form id="prophylaxis-form" class="space-y-4">
          <div class="input-group">
            <label for="prophylaxis-patientName">Patient Name:</label>
            <input type="text" id="prophylaxis-patientName" required>
          </div>
          <div class="input-group">
            <label for="prophylaxis-patientIdentifier">Patient ID / Room No.:</label>
            <input type="text" id="prophylaxis-patientIdentifier" required>
          </div>
          <div class="risk-group-heading">High Risk Factors:</div>
          <div class="space-y-2">
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Mechanical Ventilation with no enteral feeding (>48h)"><span>Mechanical Ventilation with no enteral feeding (>48h)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Chronic Liver Disease"><span>Chronic Liver Disease</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Concerning Coagulopathy"><span>Concerning Coagulopathy</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Multiple Trauma, Brain Injury or Spinal Cord"><span>Multiple Trauma, Brain Injury or Spinal Cord</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Burns over 35% of total surface area"><span>Burns over 35% of total surface area</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Organ Transplant"><span>Organ Transplant</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="History of Peptic Ulcer Disease"><span>History of Peptic Ulcer Disease</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Dual Antiplatelet"><span>Dual Antiplatelet</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Septic Shock"><span>Septic Shock</span></label>
          </div>
          <div class="risk-group-heading">Moderate to Low Risk Factors:</div>
          <div class="space-y-2">
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Mechanical Ventilation with enteral nutrition"><span>Mechanical Ventilation with enteral nutrition</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Single Antiplatelet Therapy"><span>Single Antiplatelet Therapy</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Oral Anticoagulation"><span>Oral Anticoagulation</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="SepsIS"><span>Sepsis</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="ICU stay > 7 days"><span>ICU stay > 7 days</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Renal Replacement Therapy"><span>Renal Replacement Therapy</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="High Dose Steroids or Immunosuppressant"><span>High Dose Steroids or Immunosuppressant</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Shock"><span>Shock</span></label>
          </div>
          <div id="prophylaxis-result-area" class="mt-4"></div>
          <button type="submit" class="btn btn-save w-full" id="prophylaxis-save-btn">
            <span>Save Result</span>
          </button>
        </form>
      </div>
    </div>
    
    <!-- Padua View -->
    <div id="view-padua" class="view">
      <div class="calculator-view">
        <h2 class="calculator-title">Padua (VTE) Score</h2>
        <form id="padua-form" class="space-y-4">
          <div class="input-group">
            <label for="padua-patientName">Patient Name:</label>
            <input type="text" id="padua-patientName" required>
          </div>
          <div class="input-group">
            <label for="padua-patientIdentifier">Patient ID / Room No.:</label>
            <input type="text" id="padua-patientIdentifier" required>
          </div>
          <div class="risk-group-heading">Select Risk Factors:</div>
          <div class="space-y-2">
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Active cancer" data-score="3"><span>Active cancer (+3)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Previous VTE" data-score="3"><span>Previous VTE (+3)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Reduced mobility" data-score="3"><span>Reduced mobility (≥3 days) (+3)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Known thrombophilic condition" data-score="3"><span>Known thrombophilic condition (+3)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Recent trauma/surgery" data-score="2"><span>Recent trauma/surgery (≤1 mo) (+2)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Age > 70" data-score="1"><span>Age > 70 years (+1)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Heart/respiratory failure" data-score="1"><span>Heart/respiratory failure (+1)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Acute MI or ischemic stroke" data-score="1"><span>Acute MI or ischemic stroke (+1)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Acute infection/rheumatologic" data-score="1"><span>Acute infection/rheumatologic (+1)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Obesity (BMI > 30)" data-score="1"><span>Obesity (BMI > 30) (+1)</span></label>
            <label class="risk-factor-card"><input type="checkbox" name="riskFactor" value="Hormonal treatment" data-score="1"><span>Hormonal treatment (+1)</span></label>
          </div>
          <div id="padua-result-area" class="mt-4"></div>
          <button type="submit" class="btn btn-save w-full" id="padua-save-btn">
            <span>Save Score</span>
          </button>
        </form>
      </div>
    </div>
    
    <!-- IV View -->
    <div id="view-iv" class="view">
      <div class="calculator-view">
        <h2 class="calculator-title">IV Infusion Calculator</h2>
        <form id="iv-form" class="space-y-4">
          <div class="input-group">
            <label for="iv-patientName">Patient Name:</label>
            <input type="text" id="iv-patientName" required>
          </div>
          <div class="input-group">
            <label for="iv-patientIdentifier">Patient ID / Room No.:</label>
            <input type="text" id="iv-patientIdentifier" required>
          </div>
          <div class="input-group">
            <label for="iv-weight">Patient Weight (kg):</label>
            <input type="number" id="iv-weight" step="0.1" required>
          </div>
          <div class="input-group">
            <label for="iv-drugAmount">Total Drug Amount in Solution (mg):</label>
            <input type="number" id="iv-drugAmount" step="0.1" required>
          </div>
          <div class="input-group">
            <label for="iv-solutionVolume">Total Solution Volume (mL):</label>
            <input type="number" id="iv-solutionVolume" step="0.1" required>
          </div>
          <div class="input-group">
            <label for="iv-drugDose">Desired Dose:</label>
            <input type="number" id="iv-drugDose" step="0.01" required>
          </div>
          <div class="input-group">
            <label for="iv-doseUnit">Dose Unit:</label>
            <select id="iv-doseUnit" required>
              <option value="mcg/kg/min">mcg/kg/min</option>
              <option value="mcg/min">mcg/min</option>
              <option value="mg/hr">mg/hr</option>
            </select>
          </div>
          <button type="submit" class="btn w-full" id="iv-calculate-btn">
            <span>Calculate Rate</span>
          </button>
        </form>
        <div id="iv-result-area" class="mt-4"></div>
      </div>
    </div>
    
    <!-- Renal View -->
    <div id="view-renal" class="view">
      <div class="calculator-view">
        <h2 class="calculator-title">Renal Dosing (CrCl)</h2>
        <form id="renal-form" class="space-y-4">
          <div class="input-group">
            <label for="renal-age">Age (years):</label>
            <input type="number" id="renal-age" step="1">
          </div>
          <div class="input-group">
            <label for="renal-weight">Weight (kg):</label>
            <input type="number" id="renal-weight" step="0.1">
          </div>
          <div class="input-group">
            <label for="renal-creatinine">Serum Creatinine (mg/dL):</label>
            <input type="number" id="renal-creatinine" step="0.01">
          </div>
          <div class="input-group">
            <label for="renal-gender">Gender:</label>
            <select id="renal-gender">
              <option value="male">Male</option>
              <option value="female">Female</option>
            </select>
          </div>
        </form>
        <div id="renal-result-area" class="mt-4"></div>
      </div>
    </div>

    <!-- Scores View -->
    <div id="view-scores" class="view">
      <div class="calculator-view">
        <h2 class="calculator-title">Other Clinical Scores</h2>
        <p class="text-center text-gray-600 dark:text-gray-400 mb-6">More calculators are coming soon.</p>
      </div>
    </div>
    
    <!-- Converter View -->
    <div id="view-converter" class="view">
      <div class="calculator-view">
        <h2 class="calculator-title">Unit Converter</h2>
        <form id="converter-form" class="space-y-4">
          <div class="input-group">
            <label for="converter-fromValue">From Value:</label>
            <input type="number" id="converter-fromValue" step="any" value="1">
          </div>
          <div class="input-group">
            <label for="converter-fromUnit">From Unit:</label>
            <select id="converter-fromUnit">
              <optgroup label="Mass">
                <option value="kg">kg</option>
                <option value="g">g</option>
                <option value="mg">mg</option>
                <option value="mcg">mcg</option>
              </optgroup>
              <optgroup label="Volume">
                <option value="L">L</option>
                <option value="mL">mL</option>
              </optgroup>
              <optgroup label="Weight (Specific)">
                <option value="lbs_kg">Pounds (lbs)</option>
                <option value="kg_lbs">Kilograms (kg)</option>
              </optgroup>
            </select>
          </div>
          <div class="input-group">
            <label for="converter-toValue">To Value:</label>
            <input type="text" id="converter-toValue" disabled class="disabled-input">
          </div>
          <div class="input-group">
            <label for="converter-toUnit">To Unit:</label>
            <select id="converter-toUnit">
              <optgroup label="Mass">
                <option value="kg">kg</option>
                <option value="g">g</option>
                <option value="mg">mg</option>
                <option value="mcg" selected>mcg</option>
              </optgroup>
              <optgroup label="Volume">
                <option value="L">L</option>
                <option value="mL" selected>mL</option>
              </optgroup>
              <optgroup label="Weight (Specific)">
                <option value="lbs_kg">Kilograms (kg)</option>
                <option value="kg_lbs">Pounds (lbs)</toption>
              </optgroup>
            </select>
          </div>
        </form>
      </div>
    </div>

    <!-- History View -->
    <div id="view-history" class="view">
      <div class="calculator-view" style="margin-bottom: 1rem; padding: 1rem;">
        <div class="input-group" style="margin-bottom: 0;">
          <label for="history-search">Search by Patient Name:</label>
          <input type="search" id="history-search" class="search-bar" placeholder="Filter logs...">
        </div>
      </div>
      <div id="history-logs-container" class="history-view"></div>
    </div>
    
  </main>

  <!-- Bottom Nav -->
  <nav class="app-bottom-nav">
    <button id="nav-home" class="nav-button active" data-nav="dashboard">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
      <span>Home</span>
    </button>
    <button id="nav-history" class="nav-button" data-nav="history">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></svg>
      <span>History</span>
    </button>
  </nav>
  
  <!-- Password Modal -->
  <div id="password-prompt" class="hidden">
    <div id="password-modal">
      <h3 class="calculator-title">Access History</h3>
      <p class="text-center text-gray-600 dark:text-gray-400 mb-6">Password required.</p>
      <form id="password-form" class="space-y-4">
        <div class="input-group">
          <label for="password-input">Password:</label>
          <input type="password" id="password-input" required>
        </div>
        <button type="submit" class="btn w-full"><span>Unlock</span></button>
        <button type="button" id="password-cancel" class="btn w-full" style="background: #64748b;"><span>Cancel</span></button>
      </form>
    </div>
  </div>

  <script src="index.js" defer></script>

</body>
</html>
